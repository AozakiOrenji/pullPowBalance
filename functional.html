<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>电费数据</title>
    <link href="style.css" rel="stylesheet">
    <style>
        .dataUnit,.dataShow{
            font-family: "7barSp",sans-serif;
            font-size:48px;
            color:#333333;
            float:right;
        }
        .dataShow{
            color:#66ccff;
            position:absolute;
            right:0;
            top:0;
        }
        .dataUnit{
            position:relative;
            right:0;
            top:0;
        }
        #table{
            color:#66ccff;
            font-size:16px;
            font-family: "Courier New","Microsoft JhengHei UI Light",sans-serif;
        }
    </style>
</head>
<body>
<script src="lib/jquery.js"></script>
<script>
    $(document).ready(function(){
        updateData();
        timer = setInterval(updateData,60*1000);
    });
    function updateData(){
        console.log("update");
        $.ajax({
                type: "POST",
                contentType: "application/x-www-form-urlencoded",
                dataType: "html",
                url: "getFeeInfo.php?noCache=" + Math.random(),
                success: function (data) {
                    var sto = JSON.parse(data);
                    $("#kwh").html(sto["bal"]);
                    if(isNaN(Math.floor(sto["est"]))){
                        $("#day").html(sto["est"]);
                    }else{
                        $("#day").html(Math.floor(sto["est"]*100)/100);
                    }
                },
                timeout: 30000
                //没有网络就什么都不做
                    /*                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                     alert(errorThrown);
                     }*/
            }
        );
    }
</script>
<div id="container">
    <table id="table">
        <tr>
            <td>
                eleBal
            </td>
            <td>
                <div class="dataUnit">
                    000.00
                    <span id="kwh" class="dataShow">

                    </span>
                </div>
            </td>
            <td>
                kWh
            </td>
        </tr>
        <tr>
            <td>
                ETR
            </td>
            <td>
                <div class="dataUnit">
                    000.00
                    <span id="day" class="dataShow">

                    </span>
                </div>
            </td>
            <td>
                Days
            </td>
        </tr>
    </table>
</div>
</body>
</html>